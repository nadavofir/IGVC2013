var myTurtleTopic = '/turtle13/command_velocity';

var codes = ['87','83','65','68'];
var actionMap = {'87':{'linear':2.0,'angular':0.0},
                 '83':{'linear':-2.0,'angular':0.0},
                 '65':{'linear':0.0,'angular':2.0},
                 '68':{'linear':0.0,'angular':-2.0},
                };
var activeMap = {'87':false,'83':false,'65':false,'68':false};

document.onkeydown = function(evt) {
  activeMap[evt.keyCode] = true;
};
document.onkeyup = function(evt) {
  activeMap[evt.keyCode] = false;
};

setInterval(function() {
  var linear = 0;
  var angular = 0;
  for (var i = 0; i < 4; i++) {
  var code = codes[i];
    if (activeMap[code]) {
      linear += actionMap[code]['linear'];
      angular += actionMap[code]['angular'];
    }
  }
  con.publish(myTurtleTopic,'turtlesim/Velocity',{linear:linear,angular:angular});
},100);

